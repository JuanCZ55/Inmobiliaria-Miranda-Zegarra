@model IEnumerable<Inmobiliaria.Models.Inquilino>

@{
  ViewData["Title"] = "Listado de Inquilinos";
  Layout = "~/Views/Shared/_Layout.cshtml";
  var paginaActual = ViewBag.PaginaActual ?? 1;
  var totalPaginas = ViewBag.TotalPaginas ?? 1;
  var dniFiltro = ViewBag.Dni ?? "";
}

<h2>Listado de Inquilinos <a class="btn btn-primary" asp-controller="Inquilino" asp-action="Crear">+</a></h2>

<div class="container px-0 p-3">
  <form method="get" asp-action="Listar" class="d-flex mb-3">
    <div class="zeg-field" style="max-width: 300px;">
      <input type="text" id="dni" name="dni" value="@dniFiltro" class="zeg-input" placeholder=" " />
      <label for="dni">Filtrar por DNI</label>
    </div>

    <button type="submit" class="btn btn-primary ms-2 botone">Buscar</button>
  </form>
</div>


<table class="table table-hover text-center table-light">
  <thead class="table-dark ">
    <tr>
      <th>@Html.DisplayNameFor(model => model.First().IdInquilino)</th>
      <th>@Html.DisplayNameFor(model => model.First().Dni)</th>
      <th>@Html.DisplayNameFor(model => model.First().Nombre)</th>
      <th>@Html.DisplayNameFor(model => model.First().Apellido)</th>
      <th>@Html.DisplayNameFor(model => model.First().Telefono)</th>
      <th>@Html.DisplayNameFor(model => model.First().Email)</th>
      <th>@Html.DisplayNameFor(model => model.First().Direccion)</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody class="text-center">
    @foreach (var i in Model)
    {
      <tr>
        <td>@i.IdInquilino</td>
        <td>@i.Dni</td>
        <td>@i.Nombre</td>
        <td>@i.Apellido</td>
        <td>@i.Telefono</td>
        <td>@i.Email</td>
        <td>@i.Direccion</td>
        <td class="d-flex justify-content-evenly">
          <a asp-action="Modificar" asp-route-id="@i.IdInquilino" class="btn btn-warning btn-sm">Modificar</a>
          <form asp-action="Eliminar" asp-route-id="@i.IdInquilino" method="post" style="display:inline;">
            <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
          </form>
        </td>
      </tr>
    }
  </tbody>
</table>

<!-- Paginacion -->
@if (totalPaginas > 1)
{
  <nav>
    <ul class="pagination">
      @for (int i = 1; i <= totalPaginas; i++)
      {
        <li class="page-item @(i == paginaActual ? "active" : "")">
          <a class="page-link" asp-action="Listar" asp-route-dni="@dniFiltro" asp-route-PaginaActual="@i">@i</a>
        </li>
      }
    </ul>
  </nav>
}

@if (TempData["Mensaje"] != null)
{
  <div id="mensajeAlerta" class="alert alert-success">@TempData["Mensaje"]</div>
  <script>
    setTimeout(function () {
      var alerta = document.getElementById("mensajeAlerta");
      if (alerta) {
        alerta.style.transition = "opacity 0.5s ease";
        alerta.style.opacity = "0";
        setTimeout(() => alerta.remove(), 500);
      }
    }, 5000);
  </script>
}

@if (TempData["InquilinoCreado"] != null)
{
  <div id="mensajeAlerta" class="alert alert-primary">@TempData["InquilinoCreado"]</div>
  <script>
    setTimeout(function () {
      var alerta = document.getElementById("mensajeAlerta");
      if (alerta) {
        alerta.style.transition = "opacity 0.5s ease";
        alerta.style.opacity = "0";
        setTimeout(() => alerta.remove(), 500);
      }
    }, 5000);
  </script>
}
